---
title: "Statistical Inference: Simulation Exercise"
author: "Thomas Bell"
date: "20 september 2017"
output:
  html_document: 
    keep_md: yes
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(knitr)
library(reshape2)
```

# Overview
In this analysis the exponential distribution in R is compared with the Central Limit Theorem (CLT). The exponential distribution is simulated in R with rexp(n, lambda) where lambda is the rate parameter. The mean of exponential distribution is 1/lambda and the standard deviation is also 1/lambda.

The CLT states that the distribution of averages of independant and indentically distributed (iid) variables becomes that of a standard normal when the sample size increases. For this experiment we run 1000 simulations of 40 exponentials for which the mean is calculated. The distribution of means is compared with theoretical measures and with a standard normal (Gaussian).

The analysis underlined the theory: with an increased number of simulations, the distribution of averages approximates the standard normal distribution 

# Simulations
In this section we set the seed to be able to reproduce simulations. Lambda is set to 0.2 and the number of exponentials is n = 40.

To refresh our minds we first plot the exponential distribution. The next figure shows that when the number of exponentials is increased, the random generated distribution takes the shape of the exponential distribution.

For the remainder of the analysis a distribution of averages is created of 1000 simulations of 40 exponentials with density 0.2.

```{r simulations}
set.seed(1)
lambda <- .2
n <- 40

#To refresh our mind we show how an exponential distribution looks
df <- data.frame(x=seq(0,40,by=.2))
ggplot(df) + 
  stat_function(aes(x),fun=dexp, size = 1) + 
  ggtitle("Exponential distribution with density 0.2")

#By increasing n the distribution approximates the exponential distribution
df <- melt(data.frame(
  "n40" = rexp(40, lambda),
  "n100" = rexp(100, lambda),
  "n1000" = rexp(1000, lambda)
))

ggplot(df, aes(x = value)) + 
  geom_histogram(bins = 20, col = "white", fill = "navy") + 
  facet_wrap(~variable, scales = "free_y", ncol = 1) +
  ggtitle("Random deviates with increasing exponentials")

#For this research we proceed with an n of 40 for which we run a 1000 simulations for which we will investigate the distribution of the means
mns = NULL
for (i in 1 : 1000) mns = c(mns, mean(rexp(n, lambda)))
mns <- as.data.frame(mns)
```



# Sample Mean versus Theoretical Mean
In this section the sample mean is compared with the theoretical mean for the exponential distribution.

```{r compare-mean}
#theoretical mean for exponentially distributed random variables with rate parameter lambda is E[X] = 1 / lambda = beta
theoretical_mean <- 1 / lambda

#sample mean is the mean of 1000 means
sample_mean <- mean(mns$mns)
```

Theoretical mean for exponentially distributed random variables with rate parameter lambda is: E[X] = 1 / lambda = beta

For our example this results in: E[X] = 1 / `r lambda` = `r theoretical_mean`

The sample mean of our distribution of averages is `r sample_mean`

In the following figure a histogram is plotted for the distribution of averages. Here it can be seen that the distribution is centered around the theoretical mean, highlighted with the vertical red line.

``` {r mean-plot}
ggplot(mns, aes(mns)) + 
        geom_histogram(bins = 40, aes(y=..density..)) + 
        geom_density(col = 2) + 
        geom_vline(aes(xintercept=theoretical_mean), col = 2) 
```


# Sample Variance versus Theoretical Variance
Include figures (output from R) with titles. Highlight the variances you are comparing. Include text that explains your understanding of the differences of the variances.

```{r compare-variance}
#theoretical variance for exponentially distributed random variables with rate parameter lambda is Var[X] = 1 / lambda^2 = beta^2
theoretical_var <- (1 / lambda^2) / n

#sample variance is the power of sd of 1000 sds
sample_var <- var(mns$mns)


Statistic <- c("Mean","Std. Deviation")
Sample <- c(round(sample_mean,2),round(sample_var,2))
Theoretical <- c(theoretical_mean,theoretical_var)
stat_table <- data.frame(Statistic,Sample,Theoretical)
kable(stat_table)

```



# Distribution
Via figures and text, explain how one can tell the distribution is approximately normal.







## Review criteria TEMP

*Did you show where the distribution is centered at and compare it to the theoretical center of the distribution?
*Did you show how variable it is and compare it to the theoretical variance of the distribution?
*Did you perform an exploratory data analysis of at least a single plot or table highlighting basic features of the data?
*Did the student perform some relevant confidence intervals and/or tests?
*Were the results of the tests and/or intervals interpreted in the context of the problem correctly?
*Did the student describe the assumptions needed for their conclusions?


https://github.com/lgreski/datasciencectacontent/commit/47ec7efbf3b382562a4aae6f3ac3e6303f3430c5

https://github.com/lgreski/datasciencectacontent/blob/master/markdown/kableDataFrameTable.md
